# Phase1 開発計画書 (Development Plan)

## 1. Phase1 概要

### 1.1 フェーズ目的
- 写真管理機能の実装による現場効率化
- システムの基盤構築とアーキテクチャ確立
- 小規模展開による検証と改善

### 1.2 対象範囲
- **対象拠点**: 2拠点（本社・主要支店1拠点）
- **対象ユーザー**: 42名（現場作業員30名、事務員12名）
- **対象案件**: 2案件（パイロット案件）
- **開発期間**: 4ヶ月（0-4ヶ月目）

### 1.3 投資規模
- **開発費用**: 3,500万円
  - システム開発: 2,800万円
  - インフラ構築: 500万円
  - ライセンス・ツール: 200万円

---

## 2. 開発スケジュール

### 2.1 全体スケジュール（4ヶ月）

| 月 | マイルストーン | 主要成果物 | 完了基準 |
|----|---------------|-----------|---------|
| **0-1ヶ月目** | キックオフ・要件確定 | 詳細要件定義書、基本設計書 | 要件レビュー完了 |
| **1-2.5ヶ月目** | 開発・単体テスト | 写真管理機能、認証基盤 | 単体テスト完了 |
| **2.5-3.5ヶ月目** | 結合・UAT | テストレポート、修正完了 | UAT合格 |
| **3.5-4ヶ月目** | リリース準備・展開 | 運用マニュアル、研修実施 | 本番稼働開始 |

### 2.2 詳細WBS

#### Week 1-4: 要件定義・基本設計
- Week 1-2: 詳細要件定義
  - [ ] 現場ヒアリング（2拠点）
  - [ ] 写真管理フロー確認
  - [ ] 非機能要件詳細化
  - [ ] データ移行要件確定
- Week 3-4: 基本設計
  - [ ] アーキテクチャ設計
  - [ ] データベース設計
  - [ ] API設計
  - [ ] UI/UX設計

#### Week 5-10: 開発フェーズ
- Week 5-6: インフラ構築
  - [ ] AWS環境構築（VPC、RDS、S3）
  - [ ] CI/CDパイプライン構築
  - [ ] 監視・ログ基盤構築
  - [ ] セキュリティ設定
- Week 7-8: 認証・基盤機能開発
  - [ ] 認証・認可機能（Auth0統合）
  - [ ] ユーザー管理機能
  - [ ] 権限管理機能
  - [ ] 組織・拠点マスタ管理
- Week 9-10: 写真管理機能開発
  - [ ] 写真アップロード機能
  - [ ] GPS位置情報記録
  - [ ] 写真一覧・検索機能
  - [ ] 写真詳細表示・編集
  - [ ] フォルダ・タグ管理

#### Week 11-14: テストフェーズ
- Week 11-12: 結合テスト
  - [ ] 機能結合テスト
  - [ ] 性能テスト（100枚同時アップロード）
  - [ ] セキュリティテスト
  - [ ] 障害テスト
- Week 13-14: UAT（ユーザー受入テスト）
  - [ ] パイロットユーザーによる実案件テスト
  - [ ] フィードバック収集
  - [ ] 修正対応
  - [ ] 再テスト

#### Week 15-16: リリース準備
- Week 15: 本番環境準備
  - [ ] 本番環境構築
  - [ ] データ移行実施
  - [ ] 運用マニュアル作成
  - [ ] 障害対応手順作成
- Week 16: 研修・展開
  - [ ] ユーザー研修実施（42名）
  - [ ] IT部門研修実施（5名）
  - [ ] 本番リリース
  - [ ] 初期サポート体制確立

---

## 3. 開発体制

### 3.1 開発チーム構成

| 役割 | 人数 | 主要責任 | 稼働率 |
|------|------|---------|--------|
| **プロジェクトマネージャー** | 1名 | 全体統括、ステークホルダー管理 | 80% |
| **アーキテクト** | 1名 | 技術選定、アーキテクチャ設計 | 60% |
| **バックエンド開発** | 2名 | API開発、DB設計、インフラ | 100% |
| **フロントエンド開発** | 2名 | PWA開発、UI/UX実装 | 100% |
| **QAエンジニア** | 1名 | テスト設計、実施、品質保証 | 100% |
| **UI/UXデザイナー** | 1名 | 画面設計、デザイン作成 | 50% |
| **社内IT担当** | 2名 | 要件調整、受入テスト、運用準備 | 30% |

**合計**: 10名（延べ工数: 約18人月）

### 3.2 意思決定体制

```
[ステアリングコミッティ]
├─ 経営層（月1回）
│  └─ 予算承認、方針決定
├─ プロジェクト定例会議（週1回）
│  ├─ PM、アーキテクト、IT部門長
│  └─ 進捗確認、課題解決
└─ 開発チーム朝会（毎日）
   └─ タスク調整、ブロッカー解消
```

---

## 4. 主要機能仕様

### 4.1 写真管理機能

#### 4.1.1 写真アップロード
- **機能**: スマホ/タブレットから写真を撮影・アップロード
- **要件**:
  - GPS位置情報自動記録
  - 撮影日時自動記録
  - オフライン時のローカル保存
  - バックグラウンド同期（WiFi接続時）
  - 複数枚一括アップロード（最大100枚）
- **技術**:
  - PWA: Service Worker + IndexedDB
  - API: Multipart upload + S3 Direct Upload
  - GPS: Geolocation API

#### 4.1.2 写真分類・検索
- **機能**: 写真を工種・工程・日付で分類・検索
- **要件**:
  - フォルダ階層管理（案件 > 工種 > 工程）
  - タグ付け機能（複数タグ対応）
  - 全文検索（ファイル名、メモ）
  - 位置情報からの検索
  - 日付範囲検索
- **技術**:
  - PostgreSQL: Full-text search + GiST index
  - Elasticsearch: 高速検索（将来拡張）

#### 4.1.3 写真閲覧・共有
- **機能**: 写真の閲覧、コメント、共有
- **要件**:
  - サムネイル一覧表示
  - 拡大表示・スライドショー
  - 写真へのコメント追加
  - 関係者への共有（URL生成）
  - 編集履歴管理
- **技術**:
  - S3: CloudFront経由の画像配信
  - Lambda: サムネイル自動生成

### 4.2 認証・権限管理

#### 4.2.1 認証機能
- **Auth0統合**: SSO対応
- **多要素認証**: SMS/アプリ認証
- **セッション管理**: JWT（1日有効期限）

#### 4.2.2 権限管理
- **ロール定義**:
  - システム管理者（IT部門）
  - 拠点管理者（支店長）
  - 現場監督
  - 作業員
  - 閲覧専用（協力会社）
- **権限マトリックス**:

| ロール | 写真アップロード | 写真編集 | 写真削除 | ユーザー管理 |
|--------|----------------|---------|---------|-------------|
| システム管理者 | ○ | ○ | ○ | ○ |
| 拠点管理者 | ○ | ○ | ○ | △（自拠点のみ） |
| 現場監督 | ○ | ○ | △（自案件のみ） | × |
| 作業員 | ○ | △（自分のみ） | × | × |
| 閲覧専用 | × | × | × | × |

---

## 5. 技術スタック

### 5.1 インフラ・クラウド

| カテゴリ | 技術選定 | 理由 |
|---------|---------|-----|
| **クラウド** | AWS | マネージドサービス充実、IT部門負荷軽減 |
| **コンピューティング** | AWS Lambda + ECS Fargate | サーバーレス優先、運用負荷最小化 |
| **データベース** | Amazon RDS (PostgreSQL 15) | マネージドDB、PostGIS対応 |
| **ストレージ** | Amazon S3 + CloudFront | 大容量写真保存、高速配信 |
| **認証** | Auth0 | エンタープライズ認証、SSO対応 |
| **CDN** | CloudFront | 全国拠点への高速配信 |

### 5.2 アプリケーション

| 層 | 技術スタック | 理由 |
|----|-------------|-----|
| **フロントエンド** | React 18 + TypeScript | PWA対応、型安全性 |
| **PWA** | Workbox | オフライン対応、バックグラウンド同期 |
| **UIライブラリ** | Material-UI (MUI) | レスポンシブ、モバイル最適化 |
| **状態管理** | React Query + Zustand | サーバー状態管理、ローカル状態管理 |
| **バックエンド** | Node.js (NestJS) + TypeScript | 高速開発、型共有 |
| **API** | REST API + GraphQL | 段階的移行 |
| **ORM** | Prisma | 型安全なDB操作 |

### 5.3 開発・運用ツール

| 用途 | ツール | 備考 |
|------|--------|------|
| **バージョン管理** | GitHub Enterprise | プライベートリポジトリ |
| **CI/CD** | GitHub Actions | 自動ビルド・デプロイ |
| **監視** | CloudWatch + Datadog | メトリクス・ログ監視 |
| **エラー追跡** | Sentry | エラー自動検知・通知 |
| **ログ管理** | CloudWatch Logs | 集中ログ管理 |
| **プロジェクト管理** | Jira + Confluence | タスク管理・ドキュメント |

---

## 6. 非機能要件

### 6.1 性能要件

| 項目 | 目標値 | 測定方法 |
|------|--------|---------|
| **写真アップロード** | 1枚あたり3秒以内 | 4G回線、5MB画像 |
| **一括アップロード** | 100枚を5分以内 | WiFi環境 |
| **写真一覧表示** | 初期表示2秒以内 | 100件サムネイル |
| **検索応答** | 1秒以内 | 1,000件データ |
| **同時接続** | 50ユーザー | Phase1最大想定 |

### 6.2 可用性要件

| 項目 | 目標値 | 実現方法 |
|------|--------|---------|
| **稼働率** | 99.5%（月間停止3.6時間以内） | Multi-AZ構成 |
| **計画停止** | 月1回、深夜2時間以内 | メンテナンスウィンドウ |
| **バックアップ** | 日次自動バックアップ | RDS自動バックアップ |
| **復旧時間** | 4時間以内 | RDSスナップショット復元 |

### 6.3 セキュリティ要件

| 項目 | 要件 | 実現方法 |
|------|------|---------|
| **通信暗号化** | TLS 1.3 | ALB + ACM証明書 |
| **データ暗号化** | 保管データ暗号化 | S3/RDS暗号化有効 |
| **認証** | 多要素認証必須 | Auth0 MFA |
| **アクセス制御** | ロールベース権限 | RBAC実装 |
| **監査ログ** | 全操作ログ記録 | CloudTrail + 独自監査ログ |
| **脆弱性対策** | 月次脆弱性スキャン | AWS Inspector |

### 6.4 運用性要件

| 項目 | 要件 | IT部門負荷 |
|------|------|-----------|
| **定常運用** | 週10時間以内 | 監視確認、ユーザーサポート |
| **障害対応** | 1次切り分けのみ | ベンダーエスカレーション |
| **ユーザーサポート** | 社内FAQ整備 | 初期対応のみ |
| **バックアップ監視** | 自動アラート | 失敗時のみ対応 |

---

## 7. データ移行計画

### 7.1 移行対象データ

Phase1では新規データのみ（過去データ移行なし）

| データ種別 | 移行方法 | 備考 |
|-----------|---------|------|
| **ユーザーマスタ** | CSV一括登録 | 42名分 |
| **組織マスタ** | 手動登録 | 2拠点分 |
| **案件マスタ** | 手動登録 | 2案件分 |
| **過去写真** | なし | Phase2以降で検討 |

### 7.2 移行スケジュール

| タイミング | 作業内容 | 担当 |
|-----------|---------|------|
| **Week 15** | ユーザーマスタCSV作成 | 人事部 + IT部門 |
| **Week 16** | テスト環境でデータ投入テスト | IT部門 |
| **Week 16** | 本番環境データ投入 | IT部門 + ベンダー |
| **Week 16** | データ整合性確認 | IT部門 |

---

## 8. テスト計画

### 8.1 テスト種別

| テスト種別 | 期間 | 実施者 | カバレッジ目標 |
|-----------|------|--------|---------------|
| **単体テスト** | Week 7-10 | 開発者 | 80%以上 |
| **結合テスト** | Week 11-12 | QA | 主要パス100% |
| **性能テスト** | Week 12 | QA | 全性能要件 |
| **セキュリティテスト** | Week 12 | 外部ベンダー | OWASP Top 10 |
| **UAT** | Week 13-14 | パイロットユーザー | 実案件シナリオ |
| **運用テスト** | Week 15 | IT部門 | 運用手順書 |

### 8.2 UAT計画

#### パイロットユーザー
- **拠点**: 本社、主要支店1拠点
- **人数**: 各拠点6名（現場監督2名、作業員4名）
- **期間**: 2週間
- **対象案件**: 実案件2件

#### テストシナリオ
1. **写真アップロードシナリオ**
   - [ ] 現場で写真撮影（50枚）
   - [ ] オフライン保存確認
   - [ ] WiFi接続時の自動同期
   - [ ] GPS位置情報確認
2. **写真検索・閲覧シナリオ**
   - [ ] 工種別フォルダ分類
   - [ ] 日付範囲検索
   - [ ] タグ検索
   - [ ] 写真へのコメント追加
3. **権限管理シナリオ**
   - [ ] 監督と作業員の権限差異確認
   - [ ] 他案件写真の非表示確認
4. **性能シナリオ**
   - [ ] 100枚一括アップロード
   - [ ] 4G回線での応答速度

#### 合格基準
- **致命的不具合**: 0件
- **重大不具合**: 2件以下（修正完了必須）
- **軽微不具合**: 制限なし（Phase2で対応可）
- **ユーザー満足度**: 5段階評価で平均4.0以上

---

## 9. リスク管理

### 9.1 主要リスクと対策

| リスク | 影響度 | 発生確率 | 対策 |
|--------|--------|---------|------|
| **要件変更頻発** | 高 | 中 | 変更管理プロセス厳格化、スコープ凍結 |
| **開発遅延** | 高 | 中 | 週次進捗監視、早期アラート |
| **性能要件未達** | 中 | 低 | 早期性能テスト実施 |
| **セキュリティ脆弱性** | 高 | 低 | 外部セキュリティ診断 |
| **パイロットユーザー不足** | 中 | 低 | 事前アサイン、経営層承認 |
| **IT部門リソース不足** | 中 | 中 | ベンダーサポート強化 |

### 9.2 撤退基準

以下の場合、Phase1を中断しPhase2への移行を見送る:

1. **UAT不合格**: 致命的不具合3件以上
2. **性能未達**: 主要性能要件50%以上未達
3. **予算超過**: 開発費用20%以上超過
4. **ユーザー満足度**: 5段階評価で平均3.0未満

---

## 10. 成功基準（KPI）

### 10.1 Phase1終了時点のKPI

| KPI | 目標値 | 測定方法 |
|-----|--------|---------|
| **写真アップロード数** | 5,000枚 | システムログ |
| **アクティブユーザー率** | 80%以上（42名中34名） | ログイン実績 |
| **写真整理時間削減** | 50%削減（1案件10時間→5時間） | ユーザーヒアリング |
| **システム稼働率** | 99.5%以上 | CloudWatch監視 |
| **問い合わせ件数** | 週5件以下 | IT部門集計 |
| **ユーザー満足度** | 平均4.0以上 | アンケート |

### 10.2 ビジネス効果

| 効果項目 | Phase1目標 | 測定方法 |
|---------|-----------|---------|
| **作業時間削減** | 20時間/月（2案件） | タイムシート |
| **移動コスト削減** | 5万円/月 | 交通費精算 |
| **写真紛失件数** | 0件 | インシデント記録 |

---

## 11. 次フェーズへの移行判断

### 11.1 Phase2移行基準

以下すべてを満たした場合、Phase2へ移行:

1. **機能要件**: UAT合格
2. **性能要件**: 全項目達成
3. **KPI**: 6項目中5項目以上達成
4. **ユーザー満足度**: 平均4.0以上
5. **IT部門運用負荷**: 週10時間以内
6. **予算**: 開発費用3,500万円±10%以内

### 11.2 Phase1で得られる知見

- **技術的知見**:
  - PWAオフライン同期の最適化方法
  - 大容量写真アップロードの性能チューニング
  - Auth0統合のベストプラクティス
- **業務的知見**:
  - 現場作業員のシステム受容性
  - 写真分類フローの実態
  - IT部門のサポート負荷実績
- **Phase2への改善点**:
  - UIの使いやすさ改善
  - 検索機能の強化
  - 権限設計の見直し

---

## 12. ドキュメント管理

### 12.1 成果物一覧

| ドキュメント | 作成時期 | 更新頻度 | 責任者 |
|------------|---------|---------|--------|
| **詳細要件定義書** | Week 2 | 変更時 | PM |
| **基本設計書** | Week 4 | 変更時 | アーキテクト |
| **詳細設計書** | Week 6 | 変更時 | 開発リーダー |
| **テスト計画書** | Week 8 | 変更時 | QA |
| **運用マニュアル** | Week 15 | 月次 | IT部門 |
| **ユーザーマニュアル** | Week 15 | 月次 | PM |

### 12.2 ドキュメント保管場所

- **Git Repository**: `docs/02_開発フェーズ(Development-Phases)/Phase1_写真管理/`
- **Confluence**: プロジェクトスペース
- **共有ドライブ**: `\\fileserver\CDCP\Phase1\`

---

## 13. 連絡先・エスカレーション

### 13.1 プロジェクト体制

| 役割 | 氏名 | 連絡先 | エスカレーション先 |
|------|------|--------|-------------------|
| **プロジェクトオーナー** | （経営層） | - | - |
| **プロジェクトマネージャー** | （PM名） | pm@company.co.jp | プロジェクトオーナー |
| **IT部門長** | （IT部門長名） | it-manager@company.co.jp | PM |
| **開発ベンダーPM** | （ベンダーPM名） | vendor-pm@vendor.co.jp | PM |

### 13.2 エスカレーションルール

| 事象 | 1次対応 | 2次対応 | 3次対応 |
|------|---------|---------|---------|
| **システム障害** | IT部門 | 開発ベンダー | PM |
| **要件変更** | PM | IT部門長 | プロジェクトオーナー |
| **予算超過** | PM | IT部門長 | プロジェクトオーナー |
| **スケジュール遅延** | PM | IT部門長 | プロジェクトオーナー |

---

**文書管理情報**
- **作成日**: 2026-02-15
- **最終更新**: 2026-02-15
- **版数**: 1.0
- **承認者**: （PM名）
